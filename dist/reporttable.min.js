(function($){var ReportTable=function(container,options){this.container=$(container);this.options=$.extend(true,{},this.defaultOptions,options);this.buildTable()};ReportTable.prototype.buildTable=function(){this.reset();this.refreshFunct=$.proxy(this.scroll,this);this.resizeFunct=$.proxy(this.resize,this);$(window).scroll(this.refreshFunct);$(window).resize(this.resizeFunct);var scrollEventObject;var that=this;if(scrollEventObject=this.options.scrollEventObject){scrollEventObject.scroll(function(){that.scroll()})}else{this.interval=setInterval($.proxy(this.scroll,this),this.options.pollInterval)}this.resizeInterval=setInterval($.proxy(this.resize,this),this.options.resizePollInterval);this.container.bind("remove",$.proxy(function(){clearInterval(this.interval);clearInterval(this.resizeInterval);$(window).unbind("scroll",this.refreshFunct);$(window).unbind("resize",this.resizeFunct);this.scroller.remove()},this));var that=this;this.frozenIndices=[];this.container.on("colFreezeToggle",function(event,index){var widths=that.getOuterWidthsFromFirstRow();var headerHeight=that.getHeightFromHeader();var rowHeight=that.getHeightFromFirstRow();var frozenIndex=that.frozenIndices.indexOf(index);frozenIndex==-1?that.frozenIndices.push(index):that.frozenIndices.splice(frozenIndex,1);that.parentContainer.find("tr").each(function(){$(this).height(rowHeight);var child=$(this).children().eq(index);child.toggle();child.find(".freeze-column, .frozen-column").removeClass("invisible");if(!child.text().length){child.html("&nbsp;")}});that.parentContainer.find("tr").height(headerHeight);that.parentContainer.find("tr").each(function(){$(this).children("td").eq(index).width(widths[index])});that.accommodateFrozen($("#frozenCols"));that.resize()});this.frozenCols.on("rowAdded",function(event,args){var row=$(args["row"]);var clonedRow=row.clone();clonedRow.children().each(function(i){if(that.frozenIndices.indexOf(i)==-1){$(this).hide()}});row.children().each(function(i){if(that.frozenIndices.indexOf(i)!=-1){$(this).hide()}});clonedRow.height(row.height());that.frozenCols.find("tbody").append(clonedRow)})};ReportTable.prototype.accommodateFrozen=function(table){selectedRow=$(table).children().children().first();this.regularTable.css({left:this.parentContainer.find("#frozenContainer").width()})};ReportTable.prototype.reset=function(){if(typeof this.header!=="undefined")this.header.remove();if(typeof this.footer!=="undefined")this.footer.remove();this.parentContainer=this.container.parent();this.container.css({position:"relative"});this.header=$("<table>").addClass(this.options.cssPrefix+"_header").css({"table-layout":"fixed"}).append(this.container.children("thead").clone(true));this.body=this.container.children("tbody");this.footer=$("<table>").addClass(this.options.cssPrefix+"_footer").css({position:"relative","margin-top":-this.container.children("tfoot").height(),"table-layout":"fixed"}).append(this.container.children("tfoot").clone(true));this.frozenCols=this.container.clone().attr("id","frozenCols");this.frozenCols.find("td").hide();if(this.options.scrollContainer!=null)this.createFooterScrollbar();this.frozenTable=$("<div>").addClass("inline-block").attr("id","frozenContainer");this.regularTable=$("<div>").addClass("inline-block").attr("id","regularContainer");this.frozenHeader=this.header.clone(true).attr("id","frozenHeader");this.frozenHeader.find(".freeze-column").toggleClass("freeze-column frozen-column");this.frozenHeader.find("td").hide();this.frozenTable.append(this.frozenHeader);this.frozenTable.append(this.frozenCols);this.frozenFooter=this.footer.clone().attr("id","frozenFooter");this.frozenFooter.find("td").hide();this.frozenTable.append(this.frozenFooter);this.container.before(this.frozenTable);this.container.before(this.regularTable);this.regularTable.append(this.container);this.container.before(this.header);this.container.after(this.footer);this.frozenTable.find("table").eq(1).find("thead, tfoot").css("visibility","hidden");this.regularTable.find("table").eq(1).find("thead, tfoot").css("visibility","hidden");this.refresh()};ReportTable.prototype.refresh=function(){this.resize();this.scroll()};ReportTable.prototype.scroll=function(){if($(window).scrollTop()+$(window).height()>$(document).height())return;this.moveHeader();this.moveFooter()};ReportTable.prototype.moveHeader=function(){var headers=$("#regularContainer").find(".reporttable_header");var offset=this.options.offsetHeaderHeight-this.container.offset().top;if(offset<0)offset=0;$(".reporttable_header").css("top",offset)};ReportTable.prototype.moveFooter=function(){var hasScroller=typeof this.scroller!=="undefined";var startingPosition=this.container.height()+this.container.offset().top;var offset=-(startingPosition-$(window).height())+$(window).scrollTop()-this.options.offsetFooterHeight;if(hasScroller)offset-=this.scroller.height()-2;if(offset>0||offset+this.container.outerHeight()<0)offset=0;this.footer.css("top",offset);this.frozenFooter.css("top",offset);if(hasScroller){this.scroller.css("top",offset-this.scroller.height()-2);this.scroller.width(this.options.scrollContainer.width())}};ReportTable.prototype.resize=function(){this.resizeHeader();this.resizeFooter()};ReportTable.prototype.resizeHeader=function(){var widths=this.getOuterWidthsFromFirstRow();var that=this;this.header.width(this.body.width());this.header.find("tr").each(function(rowCount){$(this).children().each(function(index){if(index>=widths.length){return false}$(this).css("min-width",widths[index]);$(this).css("max-width",widths[index])})});this.scroller.width(this.options.scrollContainer.width());this.scroller.find("."+this.options.cssPrefix+"_scrollbarInner").width(this.container.width())};ReportTable.prototype.resizeFooter=function(){var widths=this.getWidthsFromFirstRow();var that=this;this.footer.width(this.body.width());this.footer.find("tr").each(function(rowCount){$(this).find("td").each(function(index){if(index>=widths.length)return false;$(this).width(widths[index])})})};ReportTable.prototype.createFooterScrollbar=function(){if(this.options.scrollContainer==null||typeof this.scroller!=="undefined"){return}if(this.options.scrollContainer.parent().find("."+this.options.cssPrefix+"_scrollbar").length>0){this.scroller=this.options.scrollContainer.parent().find("."+this.options.cssPrefix+"_scrollbar");return}this.scroller=$("<div>").addClass(this.options.cssPrefix+"_scrollbar");this.scroller.css({position:"relative","overflow-x":"auto","overflow-y":"hidden","z-index":6,width:this.options.scrollContainer.width()});var innerScroll=$("<div>").addClass(this.options.cssPrefix+"_scrollbarInner");innerScroll.css({width:this.container.width(),height:0});this.options.scrollContainer.unbind("scroll",this.scrollContainerScrollEvent);this.scrollContainerScrollEvent=$.proxy(this.scrollScrollbar,this);this.options.scrollContainer.scroll(this.scrollContainerScrollEvent);innerScroll.html("&nbsp;");this.scroller.scroll($.proxy(this.scrollContainer,this));this.scroller.append(innerScroll);this.options.scrollContainer.after(this.scroller)};ReportTable.prototype.scrollContainer=function(event){this.options.scrollContainer.scrollLeft(this.scroller.scrollLeft())};ReportTable.prototype.scrollScrollbar=function(event){this.scroller.scrollLeft(this.options.scrollContainer.scrollLeft())};ReportTable.prototype.getWidthsFromFirstRow=function(){var firstRow=this.body.find("tr").eq(0);var widths=[];firstRow.find("td").each(function(index){widths.push($(this).width())});return widths};ReportTable.prototype.getOuterWidthsFromFirstRow=function(){var firstRow=this.body.find("tr").eq(0);var widths=[];firstRow.find("td").each(function(index){widths.push($(this).outerWidth())});return widths};ReportTable.prototype.getHeightFromHeader=function(){var height=0;this.header.find("tr").each(function(index){var newHeight=$(this).height();if(height<newHeight){height=newHeight}});return height};ReportTable.prototype.getHeightFromFirstRow=function(){var firstRow=this.body.find("tr").eq(0);return $(firstRow).height()};ReportTable.prototype.defaultOptions={offsetHeaderHeight:0,offsetFooterHeight:0,cssPrefix:"reporttable",pollInterval:400,resizePollInterval:2e3,headerCell:"th",scrollContainer:null,scrollEventObject:null};$.fn.reportTable=function(options){return this.each(function(){$(this).data("reportTable",new ReportTable(this,options))})};if(typeof define==="function"&&define.amd){define(["jquery"],function($){"use strict";return ReportTable})}})(jQuery);
//# sourceMappingURL=reporttable.map